# ğŸš€ 2026-01-15 éƒ¨ç½²äº¤ä»˜æ¸…å•

## ğŸ“¦ äº¤ä»˜å†…å®¹

### 1. åç«¯jaråŒ…
- **æ–‡ä»¶**: `stmc-boot-mini/stmc-server/target/stmc-server.jar`
- **çŠ¶æ€**: âœ… å·²ç¼–è¯‘ï¼ˆBuild SUCCESSï¼‰
- **ç¼–è¯‘æ—¶é—´**: 2026-01-15 18:35:09

### 2. å‰ç«¯diståŒ…
- **ç›®å½•**: `stmc-ui-admin-vue3/dist/`
- **çŠ¶æ€**: âœ… å·²æ‰“åŒ…ï¼ˆBuild successfulï¼‰
- **åŒ…å«æ–‡ä»¶**: æ‰€æœ‰é™æ€èµ„æºæ–‡ä»¶

### 3. æ•°æ®åº“è„šæœ¬

#### 187æµ‹è¯•ç¯å¢ƒ
- **æ–‡ä»¶**: `stmc-boot-mini/sql/deployment_187_20260115.sql`
- **å†…å®¹**:
  - æˆæœ¬ç¼–è¾‘æƒé™ï¼ˆmenu_id: 5047ï¼‰
  - ç»Ÿè®¡æŠ¥è¡¨æƒé™ï¼ˆmenu_id: 5063-5066ï¼‰
  - è‡ªåŠ¨ä¸ºè¶…çº§ç®¡ç†å‘˜å’ŒBossåˆ†é…æƒé™

#### 47ç”Ÿäº§ç¯å¢ƒ
- **æ–‡ä»¶**: `stmc-boot-mini/sql/deployment_47_20260115.sql`
- **å†…å®¹**:
  - æˆæœ¬ç¼–è¾‘æƒé™ï¼ˆmenu_id: 5047ï¼‰
  - ç»Ÿè®¡æŠ¥è¡¨æƒé™ï¼ˆmenu_id: 5063, 5065, 5066, **5075**ï¼‰
  - âš ï¸ ç‰¹åˆ«å¤„ç†äº†47ç”Ÿäº§ç¯å¢ƒçš„å®¢æˆ·é”€å”®ç»Ÿè®¡menu_idå·®å¼‚
  - è‡ªåŠ¨ä¸ºè¶…çº§ç®¡ç†å‘˜å’ŒBossåˆ†é…æƒé™

### 4. éƒ¨ç½²æ–‡æ¡£
- **æ–‡ä»¶**: `stmc-boot-mini/DEPLOYMENT_2026-01-15.md`
- **å†…å®¹**: å®Œæ•´çš„éƒ¨ç½²æ­¥éª¤ã€éªŒè¯æ¸…å•ã€å›æ»šæ–¹æ¡ˆ

---

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½

### 1. è®¢å•æˆæœ¬ç¼–è¾‘
- Bosså’Œè¶…çº§ç®¡ç†å‘˜å¯ä»¥ç¼–è¾‘å·²å®Œæˆè®¢å•çš„æˆæœ¬
- è‡ªåŠ¨åŒæ­¥ä»˜æ¬¾å•å’Œä»˜æ¬¾è®¡åˆ’ï¼ˆç‰©ç†åˆ é™¤+é‡æ–°ç”Ÿæˆï¼‰
- ä¸ä¿®æ”¹è®¢å•çš„`paidAmount`å­—æ®µï¼ˆå®¢æˆ·ä»˜æ¬¾é‡‘é¢ï¼‰

### 2. Bossè§’è‰²æƒé™ä¿®å¤
- åŒ…å«ä¹‹å‰çš„ç»Ÿè®¡æŠ¥è¡¨æƒé™ä¿®å¤
- ç¡®ä¿Bossè§’è‰²å¯ä»¥è®¿é—®ç»Ÿè®¡æŠ¥è¡¨åŠŸèƒ½

### 3. Bugä¿®å¤
- ä¿®å¤æ—¥æœŸé€‰æ‹©å™¨é”™è¯¯ï¼ˆæ”¯æŒæ•°ç»„å’Œå­—ç¬¦ä¸²æ ¼å¼ï¼‰
- ä¿®å¤ä»˜æ¬¾æ—¥æœŸä¸ºnullæ—¶çš„æ•°æ®åº“çº¦æŸé”™è¯¯
- ä¿®å¤è®¢å•åˆ—è¡¨æ–‡æ¡ˆï¼ˆ"ä»˜æ¬¾çŠ¶æ€" â†’ "æ”¶æ¬¾çŠ¶æ€"ï¼‰

---

## ğŸ“‹ ä¿®æ”¹æ–‡ä»¶æ¸…å•

### åç«¯æ–‡ä»¶ï¼ˆ7ä¸ªï¼‰
1. `OrderController.java` - æ–°å¢ editOrderCost API
2. `OrderService.java` - æ–°å¢æ¥å£æ–¹æ³•
3. `OrderServiceImpl.java` - å®ç°ç®€åŒ–ç‰ˆæˆæœ¬ç¼–è¾‘é€»è¾‘
4. `PaymentMapper.java` - æ–°å¢ deleteByOrderId()
5. `PaymentPlanMapper.java` - æ–°å¢ deleteByOrderId()
6. `PaymentServiceImpl.java` - ä¿®å¤nullæ—¥æœŸå¤„ç†
7. `ErrorCodeConstants.java` - æ–°å¢2ä¸ªé”™è¯¯ç 

### å‰ç«¯æ–‡ä»¶ï¼ˆ4ä¸ªï¼‰
1. `src/views/erp/order/index.vue` - æ·»åŠ ç¼–è¾‘æŒ‰é’®ï¼Œä¿®æ”¹æ–‡æ¡ˆ
2. `src/views/erp/order/CostForm.vue` - ä¿®å¤æ—¥æœŸæ ¼å¼ï¼Œæ”¯æŒç¼–è¾‘æ¨¡å¼
3. `src/router/modules/remaining.ts` - æ–°å¢è®¢å•è·¯ç”±
4. `src/api/erp/order/index.ts` - æ–°å¢APIæ–¹æ³•

---

## ğŸ”§ éƒ¨ç½²æ­¥éª¤ï¼ˆå¿«é€Ÿå‚è€ƒï¼‰

### 187æµ‹è¯•ç¯å¢ƒ

```bash
# 1. æ‰§è¡ŒSQLè„šæœ¬
mysql -h 192.168.1.187 -u root -p stmc_erp < sql/deployment_187_20260115.sql

# 2. ä¸Šä¼ å¹¶é‡å¯åç«¯
scp stmc-server/target/stmc-server.jar root@192.168.1.187:/app/erp/
ssh root@192.168.1.187
systemctl stop stmc-erp
redis-cli FLUSHALL
systemctl start stmc-erp

# 3. ä¸Šä¼ å‰ç«¯ï¼ˆå¦‚éœ€è¦ï¼‰
scp -r dist/* root@192.168.1.187:/var/www/html/erp/
```

### 47ç”Ÿäº§ç¯å¢ƒï¼ˆéœ€å¤‡ä»½ï¼ï¼‰

```bash
# âš ï¸ 1. å¤‡ä»½æ•°æ®åº“ï¼ˆå¿…é¡»ï¼ï¼‰
mysqldump -h 192.168.1.47 -u root -p stmc_erp > backup_47_prod_20260115.sql

# 2. æ‰§è¡ŒSQLè„šæœ¬
mysql -h 192.168.1.47 -u root -p stmc_erp < sql/deployment_47_20260115.sql

# 3. å¤‡ä»½å¹¶ä¸Šä¼ åç«¯
ssh root@192.168.1.47
cp /app/erp/stmc-server.jar /app/erp/stmc-server.jar.backup.20260115
scp stmc-server/target/stmc-server.jar root@192.168.1.47:/app/erp/

# 4. é‡å¯åç«¯æœåŠ¡
systemctl stop stmc-erp
redis-cli FLUSHALL
systemctl start stmc-erp

# 5. å¤‡ä»½å¹¶ä¸Šä¼ å‰ç«¯
mv /var/www/html/erp /var/www/html/erp.backup.20260115
scp -r dist/* root@192.168.1.47:/var/www/html/erp/
```

---

## âœ… éªŒè¯æ¸…å•

### æƒé™éªŒè¯
- [ ] Bossç™»å½•åå¯ä»¥çœ‹åˆ°ç»Ÿè®¡æŠ¥è¡¨èœå•
- [ ] Bosså¯ä»¥çœ‹åˆ°"ç¼–è¾‘"æŒ‰é’®ï¼ˆå·²å®Œæˆä¸”å·²å¡«å……æˆæœ¬çš„è®¢å•ï¼‰
- [ ] æ™®é€šä¸šåŠ¡å‘˜çœ‹ä¸åˆ°"ç¼–è¾‘"æŒ‰é’®

### åŠŸèƒ½éªŒè¯
- [ ] ç‚¹å‡»"ç¼–è¾‘"æŒ‰é’®ï¼Œæˆæœ¬ç¼–è¾‘è¡¨å•æ­£å¸¸æ‰“å¼€
- [ ] ä¿®æ”¹é‡‡è´­é‡‘é¢ï¼Œæäº¤æˆåŠŸ
- [ ] è®¢å•æˆæœ¬æ±‡æ€»å­—æ®µå·²æ›´æ–°
- [ ] ä»˜æ¬¾å•å’Œä»˜æ¬¾è®¡åˆ’å·²åŒæ­¥æ›´æ–°
- [ ] æ—¥æœŸé€‰æ‹©å™¨ä¸æŠ¥é”™

### æ–‡æ¡ˆéªŒè¯
- [ ] è®¢å•åˆ—è¡¨æ˜¾ç¤º"æ”¶æ¬¾çŠ¶æ€"ï¼ˆè€Œé"ä»˜æ¬¾çŠ¶æ€"ï¼‰
- [ ] çŠ¶æ€æ˜¾ç¤º"å·²æ”¶æ¬¾"æˆ–"æœªæ”¶æ¬¾"

---

## ğŸ“Š æƒé™å¯¹æ¯”ï¼ˆ187 vs 47ï¼‰

| èœå• | 187 menu_id | 47 menu_id | è¯´æ˜ |
|------|-------------|------------|------|
| æˆæœ¬ç¼–è¾‘ | 5047 | 5047 | âœ… ç›¸åŒ |
| ç»Ÿè®¡æŠ¥è¡¨ | 5063 | 5063 | âœ… ç›¸åŒ |
| å®¢æˆ·é”€å”®ç»Ÿè®¡ | 5064 | **5075** | âš ï¸ ä¸åŒï¼ |
| ä¾›åº”å•†é‡‡è´­ç»Ÿè®¡ | 5065 | 5065 | âœ… ç›¸åŒ |
| å‘˜å·¥é”€å”®ç»Ÿè®¡ | 5066 | 5066 | âœ… ç›¸åŒ |

---

## âš ï¸ é‡è¦æé†’

1. **47ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²å‰å¿…é¡»å¤‡ä»½æ•°æ®åº“**
2. **å»ºè®®åœ¨ä¸šåŠ¡ä½å³°æœŸï¼ˆå¤œé—´22:00-æ¬¡æ—¥6:00ï¼‰è¿›è¡Œéƒ¨ç½²**
3. **éƒ¨ç½²åå¿…é¡»æ¸…ç©ºRedisç¼“å­˜**ï¼š`redis-cli FLUSHALL`
4. **47ç”Ÿäº§ç¯å¢ƒçš„å®¢æˆ·é”€å”®ç»Ÿè®¡menu_idæ˜¯5075ï¼ˆä¸187ä¸åŒï¼‰**

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚é‡åˆ°é—®é¢˜ï¼Œè¯·å‚è€ƒï¼š
- **è¯¦ç»†éƒ¨ç½²æ–‡æ¡£**: `DEPLOYMENT_2026-01-15.md`
- **å›æ»šæ–¹æ¡ˆ**: è§éƒ¨ç½²æ–‡æ¡£ç¬¬å››éƒ¨åˆ†

---

**éƒ¨ç½²çŠ¶æ€**:
- [ ] 187æµ‹è¯•ç¯å¢ƒå·²éƒ¨ç½²
- [ ] 187åŠŸèƒ½éªŒè¯é€šè¿‡
- [ ] 47ç”Ÿäº§ç¯å¢ƒå·²éƒ¨ç½²
- [ ] 47åŠŸèƒ½éªŒè¯é€šè¿‡

**éƒ¨ç½²æ—¥æœŸ**: ___________
**éƒ¨ç½²äºº**: ___________
**éªŒè¯äºº**: ___________
